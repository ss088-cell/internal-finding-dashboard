function copyDataInBatches() {
  // Source Google Sheet (replace with the actual source sheet ID)
  var sourceSheetId = 'SOURCE_SHEET_ID'; // Replace with your source sheet ID
  var sourceSpreadsheet = SpreadsheetApp.openById(sourceSheetId);
  var sourceSheet = sourceSpreadsheet.getSheetByName('Detail Data');
  
  // Create a new Temporary Google Sheet (standalone)
  var temporarySpreadsheet = SpreadsheetApp.create('Temporary');
  var tempSheet = temporarySpreadsheet.getActiveSheet();
  
  // Get the header row (first row)
  var header = sourceSheet.getRange(1, 1, 1, sourceSheet.getLastColumn()).getValues()[0];
  
  // Define required column names
  var requiredColumns = [
    "Host Name", "VPR", "Plugin ID", "Plugin Name", "IP", "Description", "Solution",
    "First Discovered", "Last Observed", "Days Since First Discovered", 
    "Days Since Last Observed", "Bus App Name", "VPR Remediation Due Date", 
    "VPR Compliance", "Risk Type"
  ];

  // Find the indexes of the required columns in the header
  var columnIndexes = requiredColumns.map(function(colName) {
    var index = header.indexOf(colName);
    if (index === -1) {
      throw new Error('Column not found: ' + colName);
    }
    return index;
  });

  // Set the headers in the Temporary sheet
  tempSheet.getRange(1, 1, 1, requiredColumns.length).setValues([requiredColumns]);

  // Get the total number of rows
  var totalRows = sourceSheet.getLastRow();

  // List of application names (replace with your actual app names)
  var appNames = ["App1", "App2", "App3", "App4", "App5", "App6", "App7", "App8", "App9", "App10", 
                  "App11", "App12", "App13", "App14", "App15", "App16", "App17", "App18"];

  // Loop through each row and check if it matches the desired applications
  for (var i = 2; i <= totalRows; i++) { // Start from row 2 (skipping the header)
    var busAppName = sourceSheet.getRange(i, header.indexOf("Bus App Name") + 1).getValue();
    
    // If the Bus App Name is in the list of applications, copy this row to the new sheet
    if (appNames.includes(busAppName)) {
      var row = [];
      for (var j = 0; j < columnIndexes.length; j++) {
        row.push(sourceSheet.getRange(i, columnIndexes[j] + 1).getValue());
      }
      tempSheet.appendRow(row); // Append the row to the new sheet
    }
  }

  // Once all data is processed, log the link to the new Temporary Sheet
  var sheetUrl = temporarySpreadsheet.getUrl();
  Logger.log('Temporary Sheet Link: ' + sheetUrl);
  
  // Optionally, send the link via email
  // MailApp.sendEmail("your-email@example.com", "Data Copy Complete", "The data copy is complete. Here is the link to the Temporary Sheet: " + sheetUrl);
}

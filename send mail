function sendEmailReport(internalFindingsSheet) {
  try {
    // Get the spreadsheet as a blob (file) - converting to .xlsx format
    var file = DriveApp.getFileById(internalFindingsSheet.getId());
    var blob = file.getAs('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');  // or 'application/pdf' if you want PDF

    // Prepare the email details
    var subject = "Internal Finding Report for Last Week_" + Utilities.formatDate(new Date(), Session.getScriptTimeZone(), "yyyy-MM-dd");
    var body = "Hi Team,\n\nPlease Find attached Internal Finding Report for Last week as well as this week.\n\nNote Below points:\n1. The Last week sheet contains last week's data.\n2. The Detail Data sheet contains this week's data.\n\nRegards,\nTeam";

    // Define recipient
    var recipient = "your_email@example.com"; // Replace with the actual recipient email address

    // Send the email with attachment
    MailApp.sendEmail({
      to: recipient,
      subject: subject,
      body: body,
      attachments: [blob] // Attach the file as a Blob object
    });

    Logger.log("Email sent successfully with the attachment.");
  } catch (e) {
    Logger.log("Error sending mail: " + e.message);
  }
}


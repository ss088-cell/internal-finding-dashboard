function sendEmailWithReport(internalFindingsSheet) {
  // Ensure the file is accessible
  var reportFile = DriveApp.getFileById(internalFindingsSheet.getId());
  
  if (!reportFile) {
    Logger.log('Error: The report file is not accessible.');
    return;  // Exit if the file is not found
  }

  // Set the subject and body for the email
  var subject = "Internal Finding Report for Last Week_" + Utilities.formatDate(new Date(), Session.getScriptTimeZone(), "yyyy-MM-dd");
  var body = "Hi Team,\n\nPlease find attached the Internal Finding Report for last week as well as this week.\n\nNote below:\n1. The Last Week Data sheet contains last week's data.\n2. The Detail Data sheet contains this week's data.\n\nRegards,\nTeam";

  try {
    // Attempt to send the email with the Google Sheets file as an attachment
    MailApp.sendEmail({
      to: 'recipient@example.com', // Replace with the recipient's email address
      subject: subject,
      body: body,
      attachments: [reportFile.getAs(MimeType.GOOGLE_SHEETS)]  // Attach the report as a Google Sheet
    });
    
    Logger.log("Email sent successfully with the report attached.");
  } catch (e) {
    Logger.log("Error sending email: " + e.message);
  }
}
